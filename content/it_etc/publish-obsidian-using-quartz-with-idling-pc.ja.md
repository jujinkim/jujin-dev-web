---
publish: true
lang: ja
title: "遊休PCでObsidianとQuartzを利用してブログを運営する"
---

## 概要
Obsidianをウェブに公開する方法は様々ありますが、最も簡単な方法は月額8ドルでObsidian Publishを利用することです。この方法はワンクリックで記事を公開でき、カスタムドメインもDNS設定を一つ行うだけで全てが自動で進むため、非常に便利という利点があります。しかし、カスタマイズが制限され、月額8ドルという金額は安くはありません。私はObsidian Sync（4ドル）を利用中ですが（カスタムシンクは不安定だと考えています）、これにわざわざ8ドルを追加で支払いたくはありませんでした。

この記事では、私が使用した方法を共有しようと思います。Obsidian Syncは使用しても使用しなくても構いませんが、公開用のコンピュータ（ホームサーバーであればなお良い）が一つ必要です。サイト自体はGitHub Pagesを使用して公開するため、ホームサーバーが24時間稼働している必要はありませんが、記事を書くたびにホームサーバーを起動する手間がかかります。個人のPCであってもスクリプトを実行するだけなので問題ありません。

このブログは、Obsidian + Sync、Quartz、そして常に電源が入っているPC（遊休PC）を組み合わせて、構築とデプロイが自動化されています。
どこでもObsidianで記事を作成して同期すれば、別のPCで自動的にビルドとデプロイのプロセスが進行する仕組みです。
これにより、ユーザーは記事の作成だけに集中できます。

## 記事の作成と同期：ObsidianとObsidian Sync
すべての記事はObsidianで作成され、自動的にMarkdown形式で保存されます。
PC、モバイルなど、Obsidianクライアントがサポートするどのデバイスからでも記事を作成・修正できます。

Obsidianの公式有料サービスであるObsidian Syncを使用して、すべてのデバイスのノートがリアルタイムで同期されます。このとき、記事をGitHub Pagesにアップロードするためのホームサーバーにもノートが同期されます。
これがこのシステムの核心であり、ローカルファイルではなくObsidianサーバーを単一の真実の源（Single Source of Truth）として使用します。もしObsidianをPCでのみ使用する場合、PCのObsidian VaultがSSOTになります。

Obsidian Syncを使用しなくても構築自体は可能です。Gitなどで独自に同期する、個人のPCでのみ使用するなど、公開するフォルダを選んでGitHubにアップロードする部分だけを自動化すればよいためです。

## 自動ビルド環境：遊休PC
自宅で常に電源が入っているPC（ホームサーバーまたはデスクトップ）がこの役割を担います。ホームサーバーがない場合は、個人のPCにも構築が可能です。
このPCにもObsidianアプリがインストールされており、同じObsidianアカウントでログインしてノートを同期します。

ホームサーバーにはLinuxをインストールし、そこで `inotify-tools` を使用してObsidian Vaultディレクトリのファイル変更をリアルタイムで検出します。
ファイルの変更が検出されると、自動的にビルドとデプロイのプロセスを開始します。
自動デプロイが不要な場合はこの部分をスキップしても構いませんが、その場合は手動でPCから以下のデプロイを実行する必要があります。

## ビルドとデプロイの自動化：Quartzとシェルスクリプト
まず、デプロイのためにはObsidian Vaultではなく、別の新しいプロジェクトフォルダを作成する必要があります。Obsidian Vaultには触れず、すべてのデプロイ作業はプロジェクトフォルダ内で行われます。

`Quartz`は静的ウェブサイトビルダーの一つで、Obsidianを公開することに最適化されたプログラムです。グラフも描画してくれ、ローカルでのビルドも可能です。

Obsidian Vault内の公開用フォルダでファイルの変更が検出されると、以下の動作を実行します。

*   **コンテンツの同期**: Obsidian Vaultの最新内容をプロジェクトの `content` ディレクトリにコピー (`rsync`)。
*   **サイトのビルド**: Quartz CLI (`npx quartz build`) を使用してMarkdownファイルを静的ウェブサイトファイルに変換し、`public` ディレクトリにビルド。
*   **Gitプッシュ**: 変更がある場合、Gitを使用して自動的にコミットし、リモートリポジトリ（GitHub）にプッシュ。

Obsidianの記事に直接触れることなく、公開用フォルダにコピーした後、そのフォルダ内のコンテンツを加工してデプロイするため、既存の記事は安全です。また、Obsidian Vault全体をデプロイするのではなく、公開用のフォルダを選択できます。そのフォルダだけが公開用フォルダとしてデプロイされるためです。

ここで言う「フォルダ内のコンテンツの加工」とは、コピー後にコンテンツに自動で肉付けをしたり、翻訳版を追加で生成したりすることを意味します。このサイトの場合、コピー後に自動で `Gemini` が3ヶ国語の翻訳版を生成します。コピー後に生成するため、元のObsidian Vaultには不要な翻訳版は表示されず、実際にファイルを「生成」してからデプロイするため、その言語でも外部から検索可能になります。

## 最終デプロイ：GitHub Pagesとカスタムドメインの接続
メインブランチに新しいコミットがプッシュされると、事前に設定されたGitHub Actionsワークフローがトリガーされます。
このワークフローは `public` ディレクトリの静的ファイルをGitHub Pagesにデプロイします。

必要であれば、ビルドをPC（サーバー）ではなくGitHub Pagesで行うこともできますが、その場合はビルド時間もかかりますし、ローカルでウェブサイトをテストするのが面倒になります。そのため、私はPC（サーバー）で事前にビルドを行い、完成したページのみをアップロードすることを選択しました。

### GitHub Pagesの設定
実際のデプロイはGitHub -> GitHub Pagesを通じて公開されます。したがって、Pagesの設定も行う必要があります。
GitHubリポジトリの設定の「Pages」セクションでGitHub Pagesを設定できます。
「Source」を「Deploy from a branch」に設定し、「Branch」を `gh-pages` （または `main` ブランチの `docs` フォルダ）に選択した後、`/(root)` フォルダを選択します。
保存するとGitHub Pagesが有効になります。

もし自身で購入したカスタムドメインがあれば、それも一緒に設定します。

## 結論
このシステムを通じて、ユーザーは記事の作成だけに集中できるようになります。Obsidianで記事を書いて保存するだけで、複雑なビルドとデプロイのプロセスが自動的に処理されます。
Obsidian Syncを中央ハブとして使用し、遊休PCを自動化エージェントとして活用することが、この仕組みの核心的なアイデアです。遊休PCがない場合は、自身のPCでデプロイスクリプトを一度実行するだけで、自動的に「`Obsidian Vault` -> `Copy to Content directory` -> `Process contents` -> `Upload(push)` -> `Publish`」が行われます。

## 追記
このすべてのプロセスを直接コーディングしたわけではなく、`Codex`、`Claude Code`、`Gemini` の助けを借りて開発しました。
個人的に、Geminiはまだローカルでのコーディング作業をプロジェクト単位で任せるには適していないと感じており、翻訳用途でのみ使用しています（3.0モデルに期待しています）。CodexやCCに、現在の自身の環境（ホームサーバーの有無など）と共に上記の内容を整理してサイトを構築してほしいと頼めば、うまくやってくれるでしょう。したがって、本文にはスクリプトコードなどは含めませんでした。アイデアを共有しますので、ご自身の環境に合わせてうまくチューニングしてください。
